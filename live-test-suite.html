<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧪 MoreMori Live-Test Suite</title>
    <style>
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f8f9fa;
        }
        
        .live-url {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #007bff;
        }
        
        .test-card h3 {
            color: #2c3e50;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status.success { background: #28a745; }
        .status.warning { background: #ffc107; }
        .status.error { background: #dc3545; }
        .status.pending { background: #6c757d; }
        
        .test-button {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .results {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .quick-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .link-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .link-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .perf-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .perf-value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .summary-card {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-top: 30px;
        }
        
        .summary-card h2 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧪 MoreMori Live-Website Test Suite</h1>
            <p>Umfassende Tests für die Live-Website</p>
            <div class="live-url">
                🌐 Live-URL: <strong>https://keen-manatee-56f4c9.netlify.app/</strong>
            </div>
        </div>

        <div class="quick-links">
            <a href="https://keen-manatee-56f4c9.netlify.app/" target="_blank" class="link-button">🌐 Live Website</a>
            <a href="https://keen-manatee-56f4c9.netlify.app/admin.html" target="_blank" class="link-button">⚙️ Admin Panel</a>
            <a href="https://keen-manatee-56f4c9.netlify.app/test-functions.html" target="_blank" class="link-button">🔧 API Tests</a>
        </div>

        <div class="test-grid">
            <!-- Website Performance Test -->
            <div class="test-card">
                <h3><span class="status pending" id="perf-status"></span> Website Performance</h3>
                <p>Teste Ladezeiten und Core Web Vitals</p>
                <button class="test-button" onclick="testPerformance()">🚀 Performance Testen</button>
                <div id="perf-results" class="results" style="display:none;"></div>
            </div>

            <!-- Admin Panel Access -->
            <div class="test-card">
                <h3><span class="status pending" id="admin-status"></span> Admin Panel Zugang</h3>
                <p>Prüfe Admin-Panel Erreichbarkeit</p>
                <button class="test-button" onclick="testAdminPanel()">⚙️ Admin Testen</button>
                <div id="admin-results" class="results" style="display:none;"></div>
            </div>

            <!-- API Connectivity -->
            <div class="test-card">
                <h3><span class="status pending" id="api-status"></span> API Verbindung</h3>
                <p>Teste Supabase und Netlify Functions</p>
                <button class="test-button" onclick="testAPI()">🔗 API Testen</button>
                <div id="api-results" class="results" style="display:none;"></div>
            </div>

            <!-- Content Loading -->
            <div class="test-card">
                <h3><span class="status pending" id="content-status"></span> Content Loading</h3>
                <p>Prüfe ob alle Inhalte korrekt laden</p>
                <button class="test-button" onclick="testContent()">📄 Content Testen</button>
                <div id="content-results" class="results" style="display:none;"></div>
            </div>

            <!-- Mobile Responsiveness -->
            <div class="test-card">
                <h3><span class="status pending" id="mobile-status"></span> Mobile Responsiveness</h3>
                <p>Teste verschiedene Bildschirmgrößen</p>
                <button class="test-button" onclick="testMobile()">📱 Mobile Testen</button>
                <div id="mobile-results" class="results" style="display:none;"></div>
            </div>

            <!-- SEO & Meta Tags -->
            <div class="test-card">
                <h3><span class="status pending" id="seo-status"></span> SEO & Meta Tags</h3>
                <p>Prüfe Suchmaschinenoptimierung</p>
                <button class="test-button" onclick="testSEO()">🔍 SEO Testen</button>
                <div id="seo-results" class="results" style="display:none;"></div>
            </div>
        </div>

        <div class="performance-grid">
            <div class="perf-card">
                <h4>Ladezeit</h4>
                <div class="perf-value" id="load-time">--</div>
                <p>Sekunden</p>
            </div>
            <div class="perf-card">
                <h4>Requests</h4>
                <div class="perf-value" id="request-count">--</div>
                <p>HTTP Requests</p>
            </div>
            <div class="perf-card">
                <h4>Page Size</h4>
                <div class="perf-value" id="page-size">--</div>
                <p>KB</p>
            </div>
            <div class="perf-card">
                <h4>Status</h4>
                <div class="perf-value" id="overall-status">📊</div>
                <p>Health</p>
            </div>
        </div>

        <button class="test-button" onclick="runAllTests()" style="width: 100%; padding: 15px; font-size: 18px; margin: 20px 0;">
            🧪 Alle Tests Durchführen
        </button>

        <div class="summary-card" style="display:none;" id="summary">
            <h2>🎉 Test-Zusammenfassung</h2>
            <div id="summary-content"></div>
        </div>
    </div>

    <script>
        const LIVE_URL = 'https://keen-manatee-56f4c9.netlify.app/';
        const ADMIN_URL = LIVE_URL + 'admin.html';
        const API_URL = LIVE_URL + '.netlify/functions/';
        
        let testResults = {};

        function updateStatus(testId, status) {
            const statusElement = document.getElementById(testId + '-status');
            statusElement.className = `status ${status}`;
        }

        function logResult(testId, message) {
            const resultsElement = document.getElementById(testId + '-results');
            resultsElement.style.display = 'block';
            resultsElement.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
            resultsElement.scrollTop = resultsElement.scrollHeight;
        }

        async function testPerformance() {
            updateStatus('perf', 'warning');
            logResult('perf', '🚀 Starte Performance-Test...');
            
            const startTime = performance.now();
            
            try {
                const response = await fetch(LIVE_URL, { 
                    method: 'GET',
                    cache: 'no-cache'
                });
                
                const endTime = performance.now();
                const loadTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (response.ok) {
                    updateStatus('perf', 'success');
                    logResult('perf', `✅ Website lädt in ${loadTime}s`);
                    logResult('perf', `✅ HTTP Status: ${response.status}`);
                    
                    document.getElementById('load-time').textContent = loadTime;
                    document.getElementById('overall-status').textContent = '✅';
                    
                    testResults.performance = { status: 'success', loadTime };
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
                
            } catch (error) {
                updateStatus('perf', 'error');
                logResult('perf', `❌ Fehler: ${error.message}`);
                testResults.performance = { status: 'error', error: error.message };
            }
        }

        async function testAdminPanel() {
            updateStatus('admin', 'warning');
            logResult('admin', '⚙️ Teste Admin Panel Zugang...');
            
            try {
                const response = await fetch(ADMIN_URL, { 
                    method: 'GET',
                    cache: 'no-cache'
                });
                
                if (response.ok) {
                    const html = await response.text();
                    
                    if (html.includes('Admin') && html.includes('Dashboard')) {
                        updateStatus('admin', 'success');
                        logResult('admin', '✅ Admin Panel ist erreichbar');
                        logResult('admin', '✅ Dashboard-Komponenten gefunden');
                        testResults.admin = { status: 'success' };
                    } else {
                        updateStatus('admin', 'warning');
                        logResult('admin', '⚠️ Admin Panel lädt, aber Struktur unvollständig');
                        testResults.admin = { status: 'warning' };
                    }
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
                
            } catch (error) {
                updateStatus('admin', 'error');
                logResult('admin', `❌ Admin Panel nicht erreichbar: ${error.message}`);
                testResults.admin = { status: 'error', error: error.message };
            }
        }

        async function testAPI() {
            updateStatus('api', 'warning');
            logResult('api', '🔗 Teste API Verbindungen...');
            
            try {
                // Test Netlify Functions Endpoint
                const functionsTest = await fetch(API_URL + 'hello', {
                    method: 'GET',
                    cache: 'no-cache'
                });
                
                if (functionsTest.status === 200 || functionsTest.status === 404) {
                    updateStatus('api', 'success');
                    logResult('api', '✅ Netlify Functions Endpoint erreichbar');
                    logResult('api', '✅ API Infrastructure funktional');
                    testResults.api = { status: 'success' };
                } else {
                    throw new Error('Functions nicht verfügbar');
                }
                
            } catch (error) {
                updateStatus('api', 'error');
                logResult('api', `❌ API Test fehlgeschlagen: ${error.message}`);
                testResults.api = { status: 'error', error: error.message };
            }
        }

        async function testContent() {
            updateStatus('content', 'warning');
            logResult('content', '📄 Teste Content Loading...');
            
            try {
                const response = await fetch(LIVE_URL);
                const html = await response.text();
                
                const contentChecks = [
                    { name: 'MoreMori Titel', check: html.includes('MoreMori') },
                    { name: '3-Schritte Konzept', check: html.includes('Schritt') },
                    { name: 'Tangzhong Methode', check: html.includes('Tangzhong') },
                    { name: 'Events/Kalender', check: html.includes('Wochenmarkt') || html.includes('Event') },
                    { name: 'Kundenbewertungen', check: html.includes('Lisa M.') || html.includes('Kunden') }
                ];
                
                const passedChecks = contentChecks.filter(check => check.check);
                
                if (passedChecks.length >= 4) {
                    updateStatus('content', 'success');
                    logResult('content', `✅ ${passedChecks.length}/5 Content-Bereiche laden korrekt`);
                    testResults.content = { status: 'success', passed: passedChecks.length };
                } else {
                    updateStatus('content', 'warning');
                    logResult('content', `⚠️ Nur ${passedChecks.length}/5 Content-Bereiche gefunden`);
                    testResults.content = { status: 'warning', passed: passedChecks.length };
                }
                
                passedChecks.forEach(check => {
                    logResult('content', `  ✅ ${check.name}`);
                });
                
            } catch (error) {
                updateStatus('content', 'error');
                logResult('content', `❌ Content Test fehlgeschlagen: ${error.message}`);
                testResults.content = { status: 'error', error: error.message };
            }
        }

        async function testMobile() {
            updateStatus('mobile', 'warning');
            logResult('mobile', '📱 Teste Mobile Responsiveness...');
            
            try {
                // Simuliere verschiedene Viewport-Größen (via Meta-Tag Check)
                const response = await fetch(LIVE_URL);
                const html = await response.text();
                
                const mobileChecks = [
                    { name: 'Viewport Meta Tag', check: html.includes('viewport') },
                    { name: 'Responsive CSS', check: html.includes('@media') || html.includes('responsive') },
                    { name: 'Mobile-friendly Layout', check: !html.includes('position: fixed') }
                ];
                
                const passedChecks = mobileChecks.filter(check => check.check);
                
                if (passedChecks.length >= 2) {
                    updateStatus('mobile', 'success');
                    logResult('mobile', '✅ Website ist mobile-optimiert');
                    testResults.mobile = { status: 'success' };
                } else {
                    updateStatus('mobile', 'warning');
                    logResult('mobile', '⚠️ Mobile Optimierung könnte verbessert werden');
                    testResults.mobile = { status: 'warning' };
                }
                
            } catch (error) {
                updateStatus('mobile', 'error');
                logResult('mobile', `❌ Mobile Test fehlgeschlagen: ${error.message}`);
                testResults.mobile = { status: 'error', error: error.message };
            }
        }

        async function testSEO() {
            updateStatus('seo', 'warning');
            logResult('seo', '🔍 Teste SEO & Meta Tags...');
            
            try {
                const response = await fetch(LIVE_URL);
                const html = await response.text();
                
                const seoChecks = [
                    { name: 'Title Tag', check: html.includes('<title>') && html.includes('MoreMori') },
                    { name: 'Meta Description', check: html.includes('description') },
                    { name: 'H1 Heading', check: html.includes('<h1>') },
                    { name: 'Structured Content', check: html.includes('<h2>') || html.includes('<h3>') }
                ];
                
                const passedChecks = seoChecks.filter(check => check.check);
                
                if (passedChecks.length >= 3) {
                    updateStatus('seo', 'success');
                    logResult('seo', `✅ ${passedChecks.length}/4 SEO-Kriterien erfüllt`);
                    testResults.seo = { status: 'success' };
                } else {
                    updateStatus('seo', 'warning');
                    logResult('seo', `⚠️ SEO könnte verbessert werden: ${passedChecks.length}/4`);
                    testResults.seo = { status: 'warning' };
                }
                
                passedChecks.forEach(check => {
                    logResult('seo', `  ✅ ${check.name}`);
                });
                
            } catch (error) {
                updateStatus('seo', 'error');
                logResult('seo', `❌ SEO Test fehlgeschlagen: ${error.message}`);
                testResults.seo = { status: 'error', error: error.message };
            }
        }

        async function runAllTests() {
            const tests = [
                testPerformance,
                testAdminPanel, 
                testAPI,
                testContent,
                testMobile,
                testSEO
            ];
            
            for (const test of tests) {
                await test();
                await new Promise(resolve => setTimeout(resolve, 1000)); // 1s Pause zwischen Tests
            }
            
            showSummary();
        }

        function showSummary() {
            const totalTests = Object.keys(testResults).length;
            const successTests = Object.values(testResults).filter(r => r.status === 'success').length;
            const warningTests = Object.values(testResults).filter(r => r.status === 'warning').length;
            const errorTests = Object.values(testResults).filter(r => r.status === 'error').length;
            
            let summaryHTML = `
                <div style="display: flex; justify-content: space-around; margin: 20px 0;">
                    <div><strong>${successTests}</strong><br>✅ Erfolgreich</div>
                    <div><strong>${warningTests}</strong><br>⚠️ Warnungen</div>
                    <div><strong>${errorTests}</strong><br>❌ Fehler</div>
                </div>
                <p><strong>Website Status: ${successTests >= 4 ? '🎉 Ausgezeichnet!' : warningTests > 0 ? '✅ Gut - Kleine Optimierungen möglich' : '⚠️ Überprüfung erforderlich'}</strong></p>
            `;
            
            document.getElementById('summary-content').innerHTML = summaryHTML;
            document.getElementById('summary').style.display = 'block';
        }

        // Auto-load basic info on page load
        window.addEventListener('load', () => {
            setTimeout(testPerformance, 1000);
        });
    </script>
</body>
</html>
